<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Details · BetaRegression.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BetaRegression.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Details</a><ul class="internal"><li><a class="tocitem" href="#What-is-beta-regression?"><span>What is beta regression?</span></a></li><li><a class="tocitem" href="#Fitting-a-model"><span>Fitting a model</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Details</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Details</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ararslan/BetaRegression.jl/blob/main/docs/src/details.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Details"><a class="docs-heading-anchor" href="#Details">Details</a><a id="Details-1"></a><a class="docs-heading-anchor-permalink" href="#Details" title="Permalink"></a></h1><h2 id="What-is-beta-regression?"><a class="docs-heading-anchor" href="#What-is-beta-regression?">What is beta regression?</a><a id="What-is-beta-regression?-1"></a><a class="docs-heading-anchor-permalink" href="#What-is-beta-regression?" title="Permalink"></a></h2><p>Beta regression is a type of regression model similar to a <a href="https://en.wikipedia.org/wiki/Generalized_linear_model">generalized linear model</a> (GLM) but with a couple of key differences. It was first described by Ferrari and Cribari-Neto (2004)<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> with later extensions by Vasconcellos and Cribari-Neto (2005)<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>, Smithson and Verkuilen (2006)<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>, Ospina et al. (2006)<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup>, and Simas et al. (2010)<sup class="footnote-reference"><a id="citeref-5" href="#footnote-5">[5]</a></sup>.</p><p>Let&#39;s briefly review some high-level ideas behind GLMs, starting with notation.</p><h3 id="A-bit-about-GLMs"><a class="docs-heading-anchor" href="#A-bit-about-GLMs">A bit about GLMs</a><a id="A-bit-about-GLMs-1"></a><a class="docs-heading-anchor-permalink" href="#A-bit-about-GLMs" title="Permalink"></a></h3><p>Let <span>$\mathbf{y} \in \mathbb{R}^n$</span> be a vector of <span>$n$</span> observed outcomes and let <span>$\mathbf{X} \in \mathbb{R}^{n \times p}$</span> be a matrix of <span>$n$</span> measurements on <span>$p$</span> independent variables. Further, let <span>$y_i \sim \mathcal{D}(\mu_i, \phi)$</span> for a distribution <span>$\mathcal{D}$</span> with parameters <span>$\mu_i$</span> and <span>$\phi$</span>. That is, each observed outcome was generated from the same overall distribution but with possibly different means <span>$\mu_i \in \mathbb{R}$</span> and a common precision parameter <span>$\phi \in \mathbb{R}$</span>. We relate the mean vector <span>$\boldsymbol{\mu}$</span> to the independent variables via a <em>link function</em> <span>$g: \mathbb{R} \mapsto \mathbb{R}$</span> and a <em>linear predictor</em> <span>$\boldsymbol{\eta} = \mathbf{X} \boldsymbol{\beta}$</span> such that <span>$\mu_i = g^{-1}(\eta_i)$</span>. Here, <span>$\boldsymbol{\beta} \in \mathbb{R}^p$</span> is a vector of regression coefficients to be estimated.</p><p>GLMs were first described by Nelder and Wedderburn (1972)<sup class="footnote-reference"><a id="citeref-6" href="#footnote-6">[6]</a></sup> and expanded upon in the classic book by McCullagh and Nelder (1989)<sup class="footnote-reference"><a id="citeref-7" href="#footnote-7">[7]</a></sup>. Nelder and Wedderburn showed that under certain conditions, most notably when <span>$\mathcal{D}$</span> is a member of the <a href="https://en.wikipedia.org/wiki/Exponential_family">exponential family</a> of distributions, the maximum likelihood estimate of <span>$\boldsymbol{\beta}$</span>, denoted <span>$\hat{\boldsymbol{\beta}}$</span>, can be found by the method of iteratively reweighted least squares (IRLS). Within this framework, <span>$\phi$</span> does not need to be estimated directly; it can be obtained simply from the deviance of the model, <span>$n$</span>, and <span>$p$</span>. This relies, however, on the orthogonality of <span>$\boldsymbol{\beta}$</span> and <span>$\phi$</span>. Indeed, orthogonality these parameters was proved for <em>all</em> GLMs by Huang and Rathouz (2017)<sup class="footnote-reference"><a id="citeref-8" href="#footnote-8">[8]</a></sup>, expanding upon much earlier results for specific models.</p><p>In Julia, the canonical implementation of GLMs is in the package <a href="https://github.com/JuliaStats/GLM.jl">GLM.jl</a>, which uses IRLS and supports specific distributions from the <a href="https://github.com/JuliaStats/Distributions.jl">Distributions.jl</a> package.</p><h3 id="The-beta-distribution"><a class="docs-heading-anchor" href="#The-beta-distribution">The beta distribution</a><a id="The-beta-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#The-beta-distribution" title="Permalink"></a></h3><p>Our primary concern will be with the <a href="https://en.wikipedia.org/wiki/Beta_distribution">beta distribution</a>, a continuous probability distribution with support on the open interval <span>$(0, 1)$</span> and two positive real shape parameters <span>$p$</span> and <span>$q$</span>. It has probability density function</p><p class="math-container">\[f(y; p, q) = \frac{y^{p - 1} (1 - y)^{q - 1}}{\Beta(p, q)}\]</p><p>where <span>$\Beta(\cdot, \cdot)$</span> is the <a href="https://en.wikipedia.org/wiki/Beta_function">beta function</a>. The beta distribution in this parameterization is available from Distributions.jl as <code>Beta</code>.</p><p>Ferrari and Cribari-Neto reparameterize the distribution in terms of a mean <span>$0 &lt; \mu &lt; 1$</span> and precision <span>$\phi &gt; 0$</span> such that</p><p class="math-container">\[\mu = \frac{p}{p + q}, \quad \quad \phi = p + q\]</p><p>In this parameterization, it&#39;s clear that <span>$\mu$</span> and <span>$\phi$</span> are not separable; indeed, <span>$\phi$</span> appears in the denominator of <span>$\mu$</span>&#39;s definition!</p><p>We then have, for <span>$y \sim \mathcal{B}(\mu, \phi)$</span>, where <span>$\mathcal{B}$</span> is the beta distribution in this parameterization, the probability density function</p><p class="math-container">\[f(y; \mu, \phi) =
    \frac{y^{\mu \phi - 1} (1 - y)^{(1 - \mu) \phi - 1}}{\Beta(\mu \phi, (1 - \mu) \phi)}\]</p><p>with</p><p class="math-container">\[\text{E}(y) = \mu, \quad \quad \text{Var}(y) = \frac{\mu (1 - \mu)}{\phi + 1}.\]</p><h3 id="Beta-regression"><a class="docs-heading-anchor" href="#Beta-regression">Beta regression</a><a id="Beta-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Beta-regression" title="Permalink"></a></h3><p>With all of these definitions in mind, we can now formulate the beta regression model. Assume now that</p><p class="math-container">\[y_i \sim \mathcal{B}(g^{-1}(\mathbf{x}_i^\top \boldsymbol{\beta}), \phi), \quad \quad
i = 1, \ldots, n\]</p><p>where the link function is <span>$g: (0, 1) \mapsto \mathbb{R}$</span> and <span>$\mathbf{x}_i^\top$</span> is the <span>$i$</span>th row of <span>$\mathbf{X}$</span>. Just like with GLMs, we&#39;re modeling <span>$\mu$</span> as a function of the linear predictor and our ultimate goal is to estimate <span>$\boldsymbol{\beta}$</span>. But since <span>$\mu$</span> depends on <span>$\phi$</span>, so does <span>$\boldsymbol{\beta}$</span>! Thus to estimate <span>$\boldsymbol{\beta}$</span>, we must also estimate <span>$\phi$</span>. As it turns out, we don&#39;t have to resort to anything fancy in order to do this; we can simply use <a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation">maximum likelihood</a>.</p><h2 id="Fitting-a-model"><a class="docs-heading-anchor" href="#Fitting-a-model">Fitting a model</a><a id="Fitting-a-model-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-a-model" title="Permalink"></a></h2><p>In BetaRegression.jl, the maximum likelihood estimation is carried out via <a href="https://en.wikipedia.org/wiki/Scoring_algorithm">Fisher scoring</a> using closed-form expressions for the score vector and expected information matrix. There is no canonical link function for the beta regression model in this parameterization in the same manner as for GLMs (anything that constrains <span>$\mu$</span> within <span>$(0, 1)$</span> will do just fine) but for simplicity the default link function is <a href="https://en.wikipedia.org/wiki/Logit">logit</a>. In the parlance of GLM.jl, this means that any <code>Link01</code> can be used and the default is <code>LogitLink</code>.</p><p>Mirroring the API for GLMs provided by GLM.jl, a beta regression model is fit by passing an explicit design matrix <code>X</code> and response vector <code>y</code> as in</p><pre><code class="language-julia hljs">fit(BetaRegressionModel, X, y, link; kwargs...)</code></pre><p>or by providing a <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a>-compatible table <code>table</code> and a formula specified via <code>@formula</code> in Wilkinson notation as in</p><pre><code class="language-julia hljs">fit(BetaRegressionModel, @formula(y ~ 1 + x1 + ... + xn), table, link; kwargs...)</code></pre><p>In both methods, the <code>link</code> argument is optional and, as previously mentioned, defaults to <code>LogitLink()</code>. The keyword arguments provide control over the fitting process as well as the ability to specify an offset and weights. (Note however that weights are currently unsupported.)</p><p>The variables passed to the model, be it by way of design matrix or formula, cannot be collinear. Unlike <code>lm</code> from GLM.jl, which provides facilities for automatically dropping collinear variables, BetaRegression.jl does not handle this case. It&#39;s up to you, dear user, to just not do that.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Ferrari, S. and Cribari-Neto, F. (2004). <em>Beta Regression for Modelling Rates and Proportions</em>. Journal of Applied Statistics, 31, issue 7, p. 799-815.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Vasconcellos, K. L. P. and Cribari-Neto F. (2005). <em>Improved Maximum Likelihood Estimation in a New Class of Beta Regression Models</em>. Brazilian Journal of Probability and Statistics, 19(1), 13–31.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Smithson, M. and Verkuilen, J. (2006). <em>A Better Lemon Squeezer? Maximum-Likelihood Regression with Beta-Distributed Dependent Variables</em>. Psychological Methods, 11(1), 54–71.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>Ospina, R., Cribari-Neto, F., and Vasconcellos K. L. P. (2006). <em>Improved Point and Interval Estimation for a Beta Regression Model</em>. Computational Statistics &amp; Data Analysis, 51(2), 960–981.</li><li class="footnote" id="footnote-5"><a class="tag is-link" href="#citeref-5">5</a>Simas, A. B., Barreto-Souza, W., and Rocha, A. V. (2010). <em>Improved Estimators for a General Class of Beta Regression Models</em>. Computational Statistics &amp; Data Analysis, 54(2), 348–366.</li><li class="footnote" id="footnote-6"><a class="tag is-link" href="#citeref-6">6</a>Nelder, J. A. and Wedderburn, R. W. M. (1972). <em>Generalized Linear Models</em>. Journal of the Royal Statistical Society. Series A (General), 135(3), 370. doi:10.2307/2344614</li><li class="footnote" id="footnote-7"><a class="tag is-link" href="#citeref-7">7</a>McCullagh, P. and Nelder, J. A. (1989). <em>Generalized Linear Models</em>. 2nd Edition, Chapman and Hall, London. doi:10.1007/978-1-4899-3242-6</li><li class="footnote" id="footnote-8"><a class="tag is-link" href="#citeref-8">8</a>Huang, A., and Rathouz, P. J. (2017). <em>Orthogonality of the Mean and Error Distribution in Generalized Linear Models</em>. Communications in statistics: theory and methods, 46(7), 3290–3296.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 28 September 2022 17:12">Wednesday 28 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
